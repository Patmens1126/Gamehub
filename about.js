async function safeJson(response) { const text = await response.text(); if (!text || text.trim() === '') { throw new Error('Empty response from server'); } try { return JSON.parse(text); } catch (e) { throw new Error('Invalid JSON response'); }
} function renderNews(items) { const grid = document.getElementById('newsGrid'); const status = document.getElementById('newsStatus'); if (!grid || !status) return; grid.innerHTML = ''; if (!Array.isArray(items) || items.length === 0) { status.innerHTML = '<span style="color:#ff6b6b;">No news available right now.</span>'; return; } status.innerHTML = ''; items.forEach(item => { const when = item.pubDate ? new Date(item.pubDate) : null; const whenText = when ? when.toLocaleString() : ''; grid.innerHTML += ` <div class="game-card"> <h3 class="match-title">${item.title}</h3> <p class="match-league">${item.source || 'Football'}</p> <p class="match-date">${whenText}</p> <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="hero-btn" style="display:inline-block; margin-top:10px;">Read</a> </div> `; });
} async function loadNews() { const status = document.getElementById('newsStatus'); if (status) status.innerHTML = '<span style="color:#ffd700;">Loading news...</span>'; try { const res = await fetch('../api/football_news'); const data = await safeJson(res); renderNews(data.items || []); } catch (err) { const fallback = [ { title: "Premier League weekend: title race heats up as top four clash", link: "#", pubDate: new Date().toISOString(), source: "GameHub News" }, { title: "Champions League: knockout stage returns with heavyweights in action", link: "#", pubDate: new Date(Date.now() - 3600 * 1000 * 6).toISOString(), source: "GameHub News" }, { title: "African stars shine abroad as leagues enter decisive phase", link: "#", pubDate: new Date(Date.now() - 3600 * 1000 * 12).toISOString(), source: "GameHub News" }, { title: "Transfer watch: January moves that could change the season", link: "#", pubDate: new Date(Date.now() - 3600 * 1000 * 20).toISOString(), source: "GameHub News" } ]; if (status) status.innerHTML = '<span style="color:#ff6b6b;">Live feed failed. Showing sample headlines for now.</span>'; renderNews(fallback); console.error('News load error:', err); }
} document.addEventListener('DOMContentLoaded', loadNews);

